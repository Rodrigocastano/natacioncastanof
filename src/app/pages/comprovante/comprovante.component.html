
<p-toolbar class="mb-0 px-0">
  <div class="p-toolbar-group-left flex items-center gap-4" style="min-height: 72px;">
    <img
      src="assets/image/natacion-castano1.png"
      alt="Logo Empresa"
      class="rounded-xl shadow-md"
      style="width: 80px; height: 80px; object-fit: contain;"
    />
    <div class="flex flex-col">
      <h2 class="m-0 text-xl font-bold">Comprobante de usuario</h2>
      <span class="text-sm text-gray-600">Club Nataci√≥n Casta√±o</span>
    </div>
  </div>
</p-toolbar>

<!-- TARJETA CONTENEDORA -->
<p-card>


<!-- FILTROS -->
<div class="flex flex-wrap align-items-center gap-3 mb-4">
  <p-calendar [(ngModel)]="fechaInicio" view="month" dateFormat="mm/yy"
              placeholder="Desde" [showIcon]="true" />

  <p-calendar [(ngModel)]="fechaFin" view="month" dateFormat="mm/yy"
              placeholder="Hasta" [showIcon]="true" />

  <!-- üîΩ Selecci√≥n de usuario -->
  <p-dropdown
    [options]="usuarios"
    [(ngModel)]="usuarioSel"
    placeholder="Seleccione usuario"
    optionLabel="nombreCompleto"
    [showClear]="true"
    [filter]="true"
    filterBy="nombreCompleto"
    class="w-60">
    <ng-template let-user pTemplate="item">
      {{ user.nombreCompleto }} 
    </ng-template>
  </p-dropdown>

   <p-button
      label="Visualizar"
      icon="pi pi-search"
      (onClick)="buscarPagos()"
      class="p-button-success"
    />
    <p-button
      label="Descargar PDF"
      icon="pi pi-file-pdf"
      (onClick)="descargarPDF()"
      class="p-button-success"
    />
</div>


  <!-- TABLA -->
  <p-table
    *ngIf="pagos.length"
    [value]="pagos"
    [responsiveLayout]="'scroll'"
    class="p-datatable-sm"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Fecha</th>
        <th class="text-right">Plan pagados</th>
        <th class="text-right">Pendiente</th>
        <th class="text-right">Abonado</th>
        <th class="text-right">Monto total</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row>
      <tr>
        <td>{{ row.mes }}</td>
        <td class="text-right">{{ row.cantidad_pagos }}</td>
        <td class="text-right">$ {{ row.total_pendiente.toFixed(2) }}</td>
        <td class="text-right">$ {{ row.total_abonado.toFixed(2) }}</td>
        <td class="text-right">$ {{ row.total_monto.toFixed(2) }}</td>
      </tr>
    </ng-template>
  </p-table>

  <!-- SIN DATOS -->
  <p
    *ngIf="!pagos.length && fechaInicio && fechaFin && usuarioSel"
    class="text-center text-color-secondary mt-3"
  >
    No se encontraron pagos para ese usuario en el rango seleccionado.
  </p>
</p-card>
